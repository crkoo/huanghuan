<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>
<script>
    var mpass="aaa111";
    function SubChk(){
        document.getElementById("ps1").innerHTML="";
        document.getElementById("ps2").innerHTML="";
        document.getElementById("ps3").innerHTML="";
        var Numflag = 0;
        var Letterflag = 0;
        var pwd = document.all.upass1.value;

        if (document.all.pass.value==''){
            document.all.pass.focus();
            document.getElementById("ps1").innerHTML='空';
            return false;
        }
        if (document.all.pass.value != mpass){
            document.getElementById("ps1").innerHTML=' 密码错误';
            return false;
        }
        if (pwd==''){
            document.all.upass1.focus();
            document.getElementById("ps2").innerHTML=' 空';
            return false;
        }
        if (pwd == mpass) {
            document.getElementById("ps2").innerHTML=' 与旧密码相同';
            return false;
        }
        if (pwd.length < 6 || pwd.length > 12) {
            document.getElementById("ps2").innerHTML=' 最少6位字符，最大12位符';
            return false;
        }
        if (document.all.upass2.value==''){
            document.all.upass2.focus();
            document.getElementById("ps3").innerHTML=' 空';
            return false;
        }
        if(document.all.upass1.value != document.all.upass2.value){
            document.all.upass2.focus();
            document.getElementById("ps3").innerHTML=' 两次密码不一致';
            return false;
        }
        for (idx = 0; idx < pwd.length; idx++) {
            //====== 密碼只可使用字母(不分大小寫)與數字
            if(!((pwd.charAt(idx)>= "a" && pwd.charAt(idx) <= "z") || (pwd.charAt(idx)>= 'A' && pwd.charAt(idx) <= 'Z') || (pwd.charAt(idx)>= '0' && pwd.charAt(idx) <= '9'))){
                document.getElementById("ps3").innerHTML=' 只能使用字母和数字';
                return false;
            }
            if ((pwd.charAt(idx)>= "a" && pwd.charAt(idx) <= "z") || (pwd.charAt(idx)>= 'A' && pwd.charAt(idx) <= 'Z')){
                Letterflag++;
            }
            if ((pwd.charAt(idx)>= "0" && pwd.charAt(idx) <= "9")){
                Numflag++;
            }
        }
        //====== 密碼需使用字母加上數字
        if (Numflag == 0 || Letterflag == 0) {
            document.getElementById("ps2").innerHTML='您的密碼需使用字母加上數字!!';
            return false;
        }

    }
</script>
<style>
    body{
        font-size: 12px;
        background-color: #F8F0E4;
    }
</style>
<body>
<form action="" method="post" id="upassform"   onsubmit="return SubChk()">
    <input name="act" type="hidden" value="1" />
    <input name="oid" type="hidden" value="8856059dc752da2d7fl225329" />
    <table  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
            <td width="156" height="35" align="right" style="font-size: 13px; color:#333;"><b>原始密码：</b></td>
            <td width="120" align="right"><input name="pass" type="password" id="pass"/></td>
            <td width="124" align="left" id="ps1" style="color:#360"></td>
        </tr>
        <tr>
            <td align="right" height="35" style="font-size: 13px;color:#333;"><b>修改密码：</b></td>
            <td align="right"><input name="upass1" type="password" id="upass1"/></td>
            <td align="left" id="ps2" style="color:#360"></td>
        </tr>
        <tr>
            <td align="right" height="35" style="font-size: 13px;color:#333;"><b>重复密码：</b></td>
            <td align="right"><input name="upass2" type="password" id="upass2"/></td>
            <td align="left" id="ps3" style="color:#360"></td>
        </tr>
    </table>
    <div style="text-align: center;border-top-width: 2px;border-top-style: solid;border-top-color: #EFCC70;">
        <font color="#FF3300">您的密码必须至少6个字符，最多12个字字符，并只能是数字，英文字母等符号，其他的符号都不能使用!!</font>

        <input name="OK" type="submit"  value="确认"  style="padding: 0px;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input name="" type="reset" value="重置" style="padding: 0px;"/><br /><br />

    </div>
</form>
</body>
</html>